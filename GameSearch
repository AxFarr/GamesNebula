from tkinter import *
from tkinter import ttk

import sqlite3
from tkinter.ttk import Treeview

db = sqlite3.connect('game nebula.db')
c = db.cursor()


class GameFrame(Frame):
    def __init__(self, master):
        Frame.__init__(self, master)

        self.master = master
        self.tableUI()
        self.gameUI()
        
        
        
    def tableUI(self):
        gs = Treeview(self)
        scrollbar = Scrollbar(self, orient = 'vertical', command = gs.yview)
        gs.configure(yscroll = scrollbar.set)
        gs['columns'] = ('name', 'genre', 'ESRB', 'publisher', 'release date', 'singleplayer', 'multiplayer', 'windows', 'ps4', 'xboxone', 'wiiu')
        gs.heading("#0", text = '', anchor = 'w')
        gs.heading('name', text = 'Name')
        gs.column('name', anchor = 'e', width = 60)
        gs.heading('genre', text = 'Genre')
        gs.column('genre', anchor = 'e', width = 60)
        gs.heading('ESRB', text = 'ESRB')
        gs.column('ESRB', anchor = 'e', width = 60)
        gs.heading('publisher', text = 'Publisher')
        gs.column('publisher', anchor = 'e', width = 60)
        gs.heading('release date', text = 'Release Date')
        gs.column('release date', anchor = 'e', width = 60)
        gs.heading('singleplayer', text = 'Single Player')
        gs.column('singleplayer', anchor = 'e', width = 60)
        gs.heading('multiplayer', text = 'Multiplayer')
        gs.column('multiplayer', anchor = 'e', width = 60)
        gs.heading('windows', text = 'Windows')
        gs.column('windows', anchor = 'e', width = 60)
        gs.heading('ps4', text = 'PS4')
        gs.column('ps4', anchor = 'e', width = 60)
        gs.heading('xboxone', text = 'XBoxOne')
        gs.column('xboxone', anchor = 'e', width = 60)
        gs.heading('wiiu', text = 'WiiU')
        gs.column('wiiu', anchor = 'e', width = 60)
        
        scrollbar.pack(side = RIGHT, fill = Y)
        gs.pack(side = RIGHT)
        self.treeview = gs
        self.grid_rowconfigure(0, weight = 1)
        self.grid_columnconfigure(0, weight = 1)
        
        
        
        
        
    def gameUI(self):

        self.master.title("Game Search")
        root.geometry('1200x400')
        root.resizable(width=FALSE, height=FALSE)
        self.pack(fill = BOTH, expand = True)
        
        frame1 = Frame(self)
        frame1.pack(fill=X)
        frame2 = Frame(self)
        frame2.pack(fill=X)
        frame3 = Frame(self)
        frame3.pack(fill=X)
        frame4 = Frame(self)
        frame4.pack(fill=X)
        frame5 = Frame(self)
        frame5.pack(fill=X)
        frame6 = Frame(self)
        frame6.pack(fill=X)
        frame7 = Frame(self)
        frame7.pack(fill=X)
        
        self.Title_label = Label(frame1, text="Title")
        self.Title_label.pack(side=LEFT, padx=5, pady=20)
        self.plat_label = Label(frame2, text="Platform")
        self.plat_label.pack(side=LEFT, padx=5, pady=5)
        self.genre_label = Label(frame3, text="Genre")
        self.genre_label.pack(side=LEFT, padx=5, pady=20)
        self.rating_label = Label(frame4, text="Rating Level")
        self.rating_label.pack(side=LEFT, padx=5, pady=20)
        self.multi_label = Label(frame5, text="Multiplayer")
        self.multi_label.pack(side=LEFT, padx=5, pady=20)
        
        self.title_entry = Entry(frame1)
        self.title_entry.pack(side=LEFT, padx=42)
        self.plat_value = StringVar(root)
        self.plat_entry = ttk.Combobox(frame2, textvariable = self.plat_value)
        self.plat_entry['values'] = ('Any', 'PS4', 'XBoxOne', 'WiiU', 'PC')
        self.plat_entry.current(0)
        self.plat_entry.pack(side=LEFT, padx=19)
        self.genre_value = StringVar(root)
        self.genre_entry = ttk.Combobox(frame3, textvariable = self.genre_value)
        self.genre_entry['values'] = ('Any', 'Action-Adventure', 'Fighting', 'Shooter', 'Party Game', 'Platformer', 'Racing', 'Rhythm Game', 'Role-Playing', 'Survival Horror')
        self.genre_entry.current(0)
        self.genre_entry.pack(side=LEFT, padx=34)
        self.rating_value = StringVar(root)
        self.rating_entry = ttk.Combobox(frame4, textvariable = self.rating_value)
        self.rating_entry['values'] = ('Any', 'Everyone', 'Teen', 'Mature')
        self.rating_entry.current(0)
        self.rating_entry.pack(side=LEFT, padx=1)
        self.multi_value = StringVar(root)
        self.multi_entry = ttk.Combobox(frame5, textvariable = self.multi_value)
        self.multi_entry['values'] = ('Any', 'TRUE', 'FALSE')
        self.multi_entry.current(0)
        self.multi_entry.pack(side = LEFT, padx=1)
        

        self.Searchbtn = Button(frame6, text="Search", command = self._search_btn_clicked)
        self.Searchbtn.pack(side=LEFT, padx=5)
          
        
        
    def _search_btn_clicked(self):
        self.treeview.delete(*self.treeview.get_children())
        gameName = self.title_entry.get()
        platform = self.plat_entry.get()
        genre = self.genre_entry.get()
        rating = self.rating_entry.get()
        multip = self.multi_entry.get()
        
        ps4 = 'False'
        xbox = 'False'
        wii = 'False'
        pc = 'False'
        egenre = 'False'
        erating = 'False'
        multi = 'False'
        
        L = []
        
        if self.title_entry.get() is not None:
            if platform == 'PS4':
                ps4 = 'True'
            elif platform == 'XBoxOne':
                xbox = 'True'
            elif platform == 'WiiU':
                wii = 'True'
            elif platform == 'PC':
                pc = 'True'
            else:
                itr = c.execute("SELECT DISTINCT * FROM games WHERE name = ?", [self.title_entry.get()]).fetchall()
                for x in itr:
                    if x not in L:
                        L.append(x)
                        
            for x in L:
                self.treeview.insert('', 0, values = x)
                
            
        
        if gameName == "":
            if platform == 'PS4':
                ps4 = 'True'
            elif platform == 'XBoxOne':
                xbox = 'True'
            elif platform == 'WiiU':
                wii = 'True'
            elif platform == 'PC':
                pc = 'True'
            if genre is not 'Any':
                egenre = 'True'
            if rating is not 'Any':
                erating = 'True'
            if multip is not 'Any':
                multi = 'True'
               
            if platform == 'Any' and genre == 'Any' and rating == 'Any' and multip == 'Any':
                itr = c.execute("SELECT DISTINCT * FROM games").fetchall()
                for x in itr:
                    if x not in L:
                        L.append(x)
                        
            if ps4 == 'True':
                if platform == 'PS4' and genre == 'Action-Adventure':
                    if platform == 'PS4' and genre == 'Action-Adventure' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Action-Adventure' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Action-Adventure' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Action-Adventure' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Action-Adventure' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Action-Adventure' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Action-Adventure' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Fighting':
                    if platform == 'PS4' and genre == 'Fighting' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Fighting' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Fighting' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Fighting' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Fighting' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Fighting' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Fighting' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Role-Playing':
                    if platform == 'PS4' and genre == 'Role-Playing' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Role-Playing' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Role-Playing' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Role-Playing' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Role-Playing' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Role-Playing' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Role-Playing' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Shooter':
                    if platform == 'PS4' and genre == 'Shooter' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Shooter' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Shooter' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Shooter' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Fighting' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Shooter' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Shooter' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Survival Horror':
                    if platform == 'PS4' and genre == 'Survival Horror' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Survival Horror' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Survival Horror' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Survival Horror' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Survival Horror' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Survival Horror' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Survival Horror' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Party Game':
                    if platform == 'PS4' and genre == 'Party Game' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Party Game' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Party Game' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Party Game' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Party Game' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Party Game' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Party Game' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Platformer':
                    if platform == 'PS4' and genre == 'Platformer' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Platformer' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Platformer' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Platformer' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Platformer' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Platformer' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Platformer' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Racing':
                    if platform == 'PS4' and genre == 'Racing' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Racing' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Racing' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Racing' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Racing' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Racing' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Racing ' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                elif platform == 'PS4' and genre == 'Rhythm Game':
                    if platform == 'PS4' and genre == 'Rhythm Game' and rating == 'Everyone':
                        itr = c.execute("SELECT * from games WHERE genre = 'Rhythm Game' AND PS4 = 'TRUE' AND ESRB = 'Everyone'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Rhythm Game' and rating == 'Teen':
                        itr = c.execute("SELECT * from games WHERE genre = 'Rhythm' AND PS4 = 'TRUE' AND ESRB = 'Teen'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    elif platform == 'PS4' and genre == 'Rhythm Game' and rating == 'Mature':
                        itr = c.execute("SELECT * from games WHERE genre = 'Rhythm Game' AND PS4 = 'TRUE' AND ESRB = 'Mature'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                    else:
                        itr = c.execute("SELECT * from games WHERE genre = 'Rhythm Game' AND PS4 = 'TRUE'").fetchall()
                        for x in itr:
                            if x not in L:
                                L.append(x)
                else :
                    itr = c.execute("SELECT DISTINCT * FROM games WHERE PS4 = 'TRUE'").fetchall()
                    for x in itr:
                        if x not in L:
                            L.append(x)
            
            if xbox == 'True':
                itr = c.execute("SELECT DISTINCT * FROM games WHERE xbone = 'TRUE'").fetchall()
                for x in itr:
                    if x not in L:
                        L.append(x)
            elif wii == 'True':
                itr = c.execute("SELECT DISTINCT * FROM games WHERE wiiu = 'TRUE'").fetchall()
                for x in itr:
                    if x not in L:
                        L.append(x)
            elif pc == 'True':
                itr = c.execute("SELECT DISTINCT * FROM games WHERE windows = 'TRUE'").fetchall()
                for x in itr:
                    if x not in L:
                        L.append(x)
                        
            if egenre == 'True':
                if platform == 'PS4' and egenre == 'True':
                    itr = c.execute("SELECT * from games WHERE genre = 'Action Role-Playing' and ps4 = 'TRUE'").fetchall()
                    for x in itr:
                        if x not in L:
                            L.append(x)
                else:
                    itr = c.execute("SELECT DISTINCT * FROM games WHERE genre = ?", [genre]).fetchall()
                    for x in itr:
                        if x not in L:
                            L.append(x)
                        
            '''if erating == 'True':
                itr = c.execute("SELECT DISTINCT * FROM games where ESRB = ?", [rating]).fetchall()
                for x in itr:
                    if x not in L:
                        L.append(x)'''
                       
            if multi == 'True':
                if multip == 'TRUE':
                    itr = c.execute("SELECT DISTINCT * FROM games WHERE multiplayer = ? AND multiplayer = 'TRUE'", [multip]).fetchall()
                    for x in itr:
                        if x not in L:
                            L.append(x)
                if multip == 'FALSE':
                    itr = c.execute("SELECT DISTINCT * FROM games WHERE multiplayer = ? AND multiplayer = 'FALSE'", [multip]).fetchall()
                    for x in itr:
                        if x not in L:
                            L.append(x)
                            
                        
            for x in L:
                self.treeview.insert('', 0, values = x)
                



root = Tk()
lf = GameFrame(root)
root.mainloop()
